(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[101],{30946:(e,s,a)=>{Promise.resolve().then(a.bind(a,66378))},66378:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>g});var t=a(95155),l=a(75828);let n=(0,l.createServerReference)("40e8f8c95b8784de62b07e06b6255bb77bab8820b8",l.callServer,void 0,l.findSourceMapURL,"createOrder");var r=a(3997),i=a(43415);let m=i.z.object({firstName:i.z.string().min(2,{message:"Имя должно содержать не менее 2-х символов"}),lastName:i.z.string().min(2,{message:"Фамилия должна содержать не менее 2-х символов"}),email:i.z.string().email({message:"Введите корректную почту"}),phone:i.z.string().min(10,{message:"Введите корректный номер телефона"}),address:i.z.string().min(5,{message:"Введите корректный адрес"}),comment:i.z.string().optional()});var o=a(26880),c=a(6672),d=a(85060),u=a(2615),f=a(12115),x=a(69606),b=a(55037);let g=()=>{let[e,s]=(0,f.useState)(!1),{totalAmount:a,updateItemQuantity:l,items:i,removeCartItem:g,loading:p}=(0,o._$)(),{data:N}=(0,u.useSession)(),h=(0,x.mN)({resolver:(0,d.u)(m),defaultValues:{email:"",firstName:"",lastName:"",phone:"",address:"",comment:""}});(0,f.useEffect)(()=>{async function e(){let e=await c.j.auth.getMe(),[s,a]=e.fullName.split(" ");h.setValue("firstName",s),h.setValue("lastName",a),h.setValue("email",e.email)}N&&e()},[N]);let v=async e=>{try{s(!0);let a=await n(e);b.default.error("Заказ успешно оформлен! \uD83D\uDCDD Переход на оплату... ",{icon:"✅"}),a&&(location.href=a)}catch(e){console.log(e),s(!1),b.default.error("Не удалось создать заказ",{icon:"❌"})}};return(0,t.jsxs)(r.mc,{className:"mt-10",children:[(0,t.jsx)(r.hE,{className:"font-extrabold mb-8 text-[36px]",text:"Оформление заказа",size:"lg"}),(0,t.jsx)(x.Op,{...h,children:(0,t.jsx)("form",{onSubmit:h.handleSubmit(v),children:(0,t.jsxs)("div",{className:"flex gap-10",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-10 flex-1 mb-20",children:[(0,t.jsx)(r.bG,{onClickCountButton:(e,s,a)=>{l(e,"plus"===a?s+1:s-1)},removeCartItem:g,items:i,loading:p}),(0,t.jsx)(r.$Y,{className:p?"opacity-40 pointer-events-none":""}),(0,t.jsx)(r.bz,{className:p?"opacity-40 pointer-events-none":""})]}),(0,t.jsx)("div",{className:"w-[450px]",children:(0,t.jsx)(r.Vx,{loading:p||e,totalAmount:a})})]})})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[734,105,221,922,441,517,977],()=>s(30946)),_N_E=e.O()}]);